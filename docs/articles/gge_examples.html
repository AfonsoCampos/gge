<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Genotype plus Genotype-By-Block-of-Environments Biplots • gge</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Genotype plus Genotype-By-Block-of-Environments Biplots">
<meta property="og:description" content="gge">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gge</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gge_examples.html">Genotype plus Genotype-By-Block-of-Environments Biplots</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kwstat/gge/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gge_examples_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Genotype plus Genotype-By-Block-of-Environments Biplots</h1>
                        <h4 class="author">Kevin Wright</h4>
            
            <h4 class="date">2020-07-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kwstat/gge/blob/master/../../../../../x/rpack/gge/vignettes/gge_examples.Rmd"><code>../../../../../x/rpack/gge/vignettes/gge_examples.Rmd</code></a></small>
      <div class="hidden name"><code>gge_examples.Rmd</code></div>

    </div>

    
    
<div id="abstract" class="section level1">
<h1 class="hasAnchor">
<a href="#abstract" class="anchor"></a>Abstract</h1>
<p>A short note about GGE and GGB biplots.</p>
</div>
<div id="r-setup" class="section level1">
<h1 class="hasAnchor">
<a href="#r-setup" class="anchor"></a>R setup</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"knitr"</span>)
<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(<span class="kw">fig.align</span><span class="kw">=</span><span class="st">"center"</span>, <span class="kw">fig.width</span><span class="kw">=</span><span class="fl">6</span>, <span class="kw">fig.height</span><span class="kw">=</span><span class="fl">6</span>)
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">width</span><span class="kw">=</span><span class="fl">90</span>)</pre></body></html></div>
<p>An example of a GGE (genotype plus genotype-by-environment) biplot similar to figure 12 of <span class="citation">Yan and Tinker (2006)</span>. The <code>flip</code> argument can be used to flip the x and y axes so that biplots are oriented as desired. Because the SVD factorization is not unique,</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">agridat</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">yan.winterwheat</span>)
<span class="no">dat1</span> <span class="kw">&lt;-</span> <span class="no">yan.winterwheat</span>

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gge</span>)
<span class="no">m1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span>(<span class="no">dat1</span>, <span class="no">yield</span>~<span class="no">gen</span>*<span class="no">env</span>, <span class="kw">scale</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span>(<span class="no">m1</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"yan.winterwheat - GGE biplot"</span>,
       <span class="kw">flip</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>), <span class="kw">origin</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">hull</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="gge_examples_files/figure-html/gge-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Many people prefer to use ‘standardized’ biplots, in which the data for each environement has been centered and scaled. For standardized biplots, a unit circle is drawn. Environment vectors that reach out to the unit circle are perfectly represented in the two dimensional plane.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">m2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span>(<span class="no">dat1</span>, <span class="no">yield</span>~<span class="no">gen</span>*<span class="no">env</span>, <span class="kw">scale</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span>(<span class="no">m2</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"yan.winterwheat - GGE biplot"</span>,
       <span class="kw">flip</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">origin</span><span class="kw">=</span><span class="fl">0</span>)</pre></body></html></div>
<p><img src="gge_examples_files/figure-html/unnamed-chunk-1-1.png" width="576" style="display: block; margin: auto;"> As seen above, the environment vectors are fairly long, so that relative performance of genotypes in environments can be assessed with reasonable accuracy. In contrast, a biplot based on principal components 2 and 3 has shorter vectors which should not be interpreted.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span>(<span class="no">m2</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"yan.winterwheat - GGE biplot - PC 2 &amp; 3"</span>,
       <span class="kw">comps</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>), <span class="kw">flip</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">origin</span><span class="kw">=</span><span class="fl">0</span>)</pre></body></html></div>
<p><img src="gge_examples_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"><span class="citation">Laffont, Hanafi, and Wright (2007)</span> showed how to partition the sums-of-squares simultaneously along the principal component axes and along ‘G’ and ‘GxE’ axes.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">m1</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"yan.winterwheat"</span>)</pre></body></html></div>
<p><img src="gge_examples_files/figure-html/mosaic-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The mosaic plot above shows that the first principal component axis is capturing almost all of the variation between genotypes, so that a projection of the genotype markers onto the first principal component axis is a good overall representation of the rankings of the genotypes.</p>
<p><span class="citation">Laffont, Wright, and Hanafi (2013)</span> presented GGB (genotype plus genotype-by-block of environments) biplots, which are useful to enhance the view of mega-environments consisting of multiple locations.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">agridat</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">crossa.wheat</span>)
<span class="no">dat2</span> <span class="kw">&lt;-</span> <span class="no">crossa.wheat</span>

<span class="co"># Define mega-environment groups of locations</span>
<span class="no">dat2</span>$<span class="no">eg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sets.html">is.element</a></span>(<span class="no">dat2</span>$<span class="no">loc</span>,
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"KN"</span>,<span class="st">"NB"</span>,<span class="st">"PA"</span>,<span class="st">"BJ"</span>,<span class="st">"IL"</span>,<span class="st">"TC"</span>,
                               <span class="st">"JM"</span>,<span class="st">"PI"</span>,<span class="st">"AS"</span>,<span class="st">"ID"</span>,<span class="st">"SC"</span>,<span class="st">"SS"</span>,
                               <span class="st">"SJ"</span>,<span class="st">"MS"</span>,<span class="st">"MG"</span>,<span class="st">"MM"</span>)), <span class="st">"Grp1"</span>, <span class="st">"Grp2"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gge</span>)
<span class="co"># Specify env.group as column in data frame</span>
<span class="no">m3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span>(<span class="no">dat2</span>, <span class="no">yield</span>~<span class="no">gen</span>*<span class="no">loc</span>, <span class="kw">env.group</span><span class="kw">=</span><span class="no">eg</span>, <span class="kw">scale</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span>(<span class="no">m3</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"crossa.wheat - GGB biplot"</span>)</pre></body></html></div>
<p><img src="gge_examples_files/figure-html/ggb-1.png" width="576" style="display: block; margin: auto;"></p>
<div id="biplot-with-genotype-focus" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-with-genotype-focus" class="anchor"></a>Biplot with genotype focus</h2>
<p>When <span class="math inline">\(\bf X\)</span> is a genotype-by-environment matrix, a <em>genotype-focused</em> biplot is easily obtained. The genotype coordinates are can be obtained from the SVD using the first two columns of <span class="math inline">\(\bf G_{gf} = U S\)</span> or equivalently from NIPALS <span class="math inline">\(\bf G_{gf} = T\)</span>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">## u &lt;- Xc.svd$u
## s &lt;- diag(Xc.svd$d)
## v &lt;- Xc.svd$v
## (u %*% s)[,1:2]
## t[,1:2]</pre></body></html></div>
<p>The environment coordinates are the first two colunns of <span class="math inline">\(\bf E_{gf} = V\)</span> (from the SVD) or <span class="math inline">\(\bf E_{gf} = P\)</span> (from NIPALS).</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">## v[,1:2]
## p[,1:2]</pre></body></html></div>
</div>
<div id="biplot-with-environment-focus" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-with-environment-focus" class="anchor"></a>Biplot with environment focus</h2>
<p>For an <em>environment-focused</em> biplot, a little more effort is needed as the eigenvalues from NIPALS are also required. The square root of the NIPALS eigenvalues are the same as the SVD singular values.</p>
<p>The genotype coordinates are the first two columns of $_{ef} = U $ (from SVD) or <span class="math inline">\(\bf G_{ef} = T \Lambda^{-1/2}\)</span> from NIPALS, where <span class="math inline">\(\bf \Lambda\)</span> is a diagonal matrix of the eigenvalues.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r">## u[,1:2]
## sv &lt;- sqrt(Xc.pca$eig)
## (t %*% diag(1/sv))[,1:2]</pre></body></html></div>
<p>The environment coordinates are <span class="math inline">\(\bf E_{ef} = V\)</span> (from SVD) or <span class="math inline">\(\bf E_{ef} = P \Lambda^{1/2}\)</span> (from NIPALS):</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">## (v %*% s)[,1:2]
## (p %*% diag(sv))[,1:2]</pre></body></html></div>
</div>
<div id="comments-on-biplots" class="section level2">
<h2 class="hasAnchor">
<a href="#comments-on-biplots" class="anchor"></a>Comments on biplots</h2>
<p>Note that GGE biplots are environment-focused. In particular, this provides the interpretation that the correlation of genotype performance in two environments is approximated by the cosine of the angle between the vectors for those two environments.</p>
<p>The SVD and NIPALS methods provide the same principal components for complete-data, except that a principal component from SVD and the corresponding principal component from NIPALS might point in opposite directions (differ by a factor of <span class="math inline">\(-1\)</span>) as in some of the examples above. The corresponding biplots would therefore be mirror-reversed along that component. For biplots from SVD and NIPALS that are visually consistent, each principal component can be directed to point in a direction that is positively correlated with the overall genotype means. In other words, if the correlation of the genotype means and the ordinate of the genotypes along the principal component is negative, the principal component is multiplied by <span class="math inline">\(-1\)</span>.</p>
<p>As with all biplots, the environment vectors can be arbitrarily scaled so that the genotypes and environments uses a similar amount of area on the plot. The algorithm that physically centers the biplot and scales it on the page is not perfect and has opportunities for improvement.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-laffont2007numerical">
<p>Laffont, Jean-Louis, Mohamed Hanafi, and Kevin Wright. 2007. “Numerical and Graphical Measures to Facilitate the Interpretation of Gge Biplots.” <em>Crop Science</em> 47: 990–96. <a href="https://doi.org/10.2135/cropsci2006.08.0549">https://doi.org/10.2135/cropsci2006.08.0549</a>.</p>
</div>
<div id="ref-laffont2013genotype">
<p>Laffont, Jean-Louis, Kevin Wright, and Mohamed Hanafi. 2013. “Genotype Plus Genotype-by-Block of Environments Biplots.” <em>Crop Science</em> 53 (6): 2332–41. <a href="https://doi.org/10.2135/cropsci2013.03.0178">https://doi.org/10.2135/cropsci2013.03.0178</a>.</p>
</div>
<div id="ref-yan2006biplot">
<p>Yan, Weikai, and Nicholas A Tinker. 2006. “Biplot Analysis of Multi-Environment Trial Data: Principles and Applications.” <em>Canadian Journal of Plant Science</em> 86: 623–45. <a href="https://doi.org/10.4141/P05-169">https://doi.org/10.4141/P05-169</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kevin Wright, Jean-Louis Laffont.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
